(function() {
  var extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  window.ColumnGraph = (function(superClass) {
    extend(ColumnGraph, superClass);

    ColumnGraph.prototype.colors = ['#ec008c', '#b3b3b3', '#249eb2', '#249eb2', '#9ac8e2', '#f2d1d9'];

    function ColumnGraph($ele, graphData, chartType, isMultiLayer) {
      this.$ele = $ele;
      this.graphData = graphData;
      this.chartType = chartType != null ? chartType : "Pie";
      this.isMultiLayer = isMultiLayer != null ? isMultiLayer : true;
      this.redrawOnResize = true;
      this.margin = {
        left: 50,
        right: 30,
        top: 30,
        bottom: 40
      };
      ColumnGraph.__super__.constructor.call(this, this.$ele, this.graphData);
    }

    ColumnGraph.prototype.onRender = function() {
      var ageGroup, area, autoDomainCalc, colorScale, firstTick, grpdGraphData, height, hoverLabel, lastTick, ref, xAxisTicks, xBar, xDomain, xScale, yAxis, yDomain, yScale;
      height = this.height;
      yScale = d3.scale.linear().range([this.height, 0]);
      xScale = d3.scale.ordinal().rangeRoundBands([0, this.width], .3);
      colorScale = d3.scale.ordinal().range(this.graphData.colors || this.colors);
      hoverLabel = d3.scale.ordinal().range(this.graphData.labels);
      yAxis = d3.svg.axis().scale(yScale).tickSize(-this.width - 5, 0, 0).ticks(5).tickFormat(function(d, index) {
        if (index === 0) {
          return '';
        } else {
          return d;
        }
      }).orient('left');
      xBar = d3.svg.axis().scale(xScale).ticks(this.graphData.data.length - 1).tickSize(height, 0, 0).tickFormat((function(_this) {
        return function(d, index) {
          return _this.graphData.data[index].label.toUpperCase();
        };
      })(this)).orient('bottom');
      grpdGraphData = this.graphData.labels.map((function(_this) {
        return function(n) {
          return _this.graphData.data.map(function(d, i) {
            return {
              x: i,
              y: d[n],
              y0: 0
            };
          });
        };
      })(this));
      d3.layout.stack()(grpdGraphData);
      autoDomainCalc = (function(_this) {
        return function(axis) {
          var callback, isString;
          isString = false;
          if (typeof _this.graphData.data[0][axis] === "string") {
            isString = true;
          }
          callback = function(d, index) {
            var k, sum, v;
            if (isString) {
              return index;
            }
            sum = 0;
            for (k in d) {
              v = d[k];
              if (k === 'label') {
                continue;
              }
              sum += v;
            }
            return sum;
          };
          return [0, d3.max(_this.graphData.data, callback) * 1.2];
        };
      })(this);
      xDomain = [0, this.graphData.data.length - 1];
      yDomain = [
        0, d3.max(this.graphData.data, function(d, i) {
          var barW;
          return d;
        }) * 1.75
      ];
      xScale.domain(xDomain);
      yScale.domain(yDomain);
      this.graphGrp.append('g').attr('class', 'xaxis').attr('transform', 'translate(0,' + 0 + ')').call(xBar);
      this.graphGrp.append('g').attr('class', 'yaxis').call(yAxis);
      area = d3.svg.area().x(function(d) {
        return xScale(d.x);
      }).y0(function(d) {
        return yScale(d.y0);
      }).y1(function(d) {
        return yScale(d.y + d.y0);
      });
      ageGroup = this.graphGrp.selectAll('.valgroup').data(grpdGraphData).enter().append('g').attr('class', 'valgroup').style('fill', function(d, i) {
        return colorScale(i);
      }).attr('class', function(d, i) {
        return hoverLabel(i);
      });
      ageGroup.append('path').attr('d', function(d) {
        return area(d);
      });
      xAxisTicks = this.svgEle.selectAll('.xaxis .tick line');
      ref = xAxisTicks[0], firstTick = ref[0], lastTick = ref[ref.length - 1];
      d3.select(firstTick).attr("transform", "translate(1,0)");
      return d3.select(lastTick).attr("transform", "translate(-1,0)");
    };

    return ColumnGraph;

  })(Graph);

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndpZGdldHMvY29sdW1uZ3JhcGguY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQTsrQkFBQTs7QUFBQSxFQUFNLE1BQU0sQ0FBQztBQUNULG1DQUFBLENBQUE7O0FBQUEsMEJBQUEsTUFBQSxHQUFTLENBQ0wsU0FESyxFQUVMLFNBRkssRUFHTCxTQUhLLEVBSUwsU0FKSyxFQUtMLFNBTEssRUFNTCxTQU5LLENBQVQsQ0FBQTs7QUFTWSxJQUFBLHFCQUFDLElBQUQsRUFBTyxTQUFQLEVBQWtCLFNBQWxCLEVBQW1DLFlBQW5DLEdBQUE7QUFFUixNQUZTLElBQUMsQ0FBQSxPQUFELElBRVQsQ0FBQTtBQUFBLE1BRmUsSUFBQyxDQUFBLFlBQUQsU0FFZixDQUFBO0FBQUEsTUFGMEIsSUFBQyxDQUFBLGdDQUFELFlBQVcsS0FFckMsQ0FBQTtBQUFBLE1BRjJDLElBQUMsQ0FBQSxzQ0FBRCxlQUFjLElBRXpELENBQUE7QUFBQSxNQUFBLElBQUMsQ0FBQSxjQUFELEdBQWtCLElBQWxCLENBQUE7QUFBQSxNQU1BLElBQUMsQ0FBQSxNQUFELEdBQVc7QUFBQSxRQUNQLElBQUEsRUFBUyxFQURGO0FBQUEsUUFFUCxLQUFBLEVBQVMsRUFGRjtBQUFBLFFBR1AsR0FBQSxFQUFTLEVBSEY7QUFBQSxRQUlQLE1BQUEsRUFBUyxFQUpGO09BTlgsQ0FBQTtBQUFBLE1BY0EsNkNBQU0sSUFBQyxDQUFBLElBQVAsRUFBWSxJQUFDLENBQUEsU0FBYixDQWRBLENBRlE7SUFBQSxDQVRaOztBQUFBLDBCQTZCQSxRQUFBLEdBQVcsU0FBQSxHQUFBO0FBV1AsVUFBQSxrS0FBQTtBQUFBLE1BQUEsTUFBQSxHQUFTLElBQUMsQ0FBQSxNQUFWLENBQUE7QUFBQSxNQUdBLE1BQUEsR0FBUyxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQVQsQ0FBQSxDQUFpQixDQUFDLEtBQWxCLENBQXdCLENBQUMsSUFBQyxDQUFBLE1BQUYsRUFBUyxDQUFULENBQXhCLENBSFQs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O2VBQ1osVUFBQSxDQUFXLENBQVgsRUFEWTtNQUFBLENBRkwsQ0ExRlgsQ0FBQTtBQUFBLE1BZ0dBLFFBQVEsQ0FBQyxNQUFULENBQWdCLE1BQWhCLENBQXVCLENBQUMsSUFBeEIsQ0FBNkIsR0FBN0IsRUFBa0MsU0FBQyxDQUFELEdBQUE7ZUFDOUIsSUFBQSxDQUFLLENBQUwsRUFEOEI7TUFBQSxDQUFsQyxDQWhHQSxDQUFBO0FBQUEsTUFvR0EsVUFBQSxHQUFhLElBQUMsQ0FBQSxNQUFNLENBQUMsU0FBUixDQUFrQixtQkFBbEIsQ0FwR2IsQ0FBQTtBQUFBLE1BcUdBLE1BQThCLFVBQVcsQ0FBQSxDQUFBLENBQXpDLEVBQUMsa0JBQUQsRUFBaUIsOEJBckdqQixDQUFBO0FBQUEsTUFzR0EsRUFBRSxDQUFDLE1BQUgsQ0FBVSxTQUFWLENBQW9CLENBQUMsSUFBckIsQ0FBMEIsV0FBMUIsRUFBdUMsZ0JBQXZDLENBdEdBLENBQUE7YUF1R0EsRUFBRSxDQUFDLE1BQUgsQ0FBVSxRQUFWLENBQW1CLENBQUMsSUFBcEIsQ0FBeUIsV0FBekIsRUFBc0MsaUJBQXRDLEVBbEhPO0lBQUEsQ0E3QlgsQ0FBQTs7dUJBQUE7O0tBRDZCLE1BQWpDLENBQUE7QUFBQSIsImZpbGUiOiJ3aWRnZXRzL2NvbHVtbmdyYXBoLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3Mgd2luZG93LkNvbHVtbkdyYXBoIGV4dGVuZHMgR3JhcGhcbiAgICBjb2xvcnMgOiBbXG4gICAgICAgICcjZWMwMDhjJ1xuICAgICAgICAnI2IzYjNiMydcbiAgICAgICAgJyMyNDllYjInXG4gICAgICAgICcjMjQ5ZWIyJ1xuICAgICAgICAnIzlhYzhlMidcbiAgICAgICAgJyNmMmQxZDknXG4gICAgXVxuXG4gICAgY29uc3RydWN0b3I6KEAkZWxlLEBncmFwaERhdGEsQGNoYXJ0VHlwZT1cIlBpZVwiLEBpc011bHRpTGF5ZXI9dHJ1ZSktPlxuXG4gICAgICAgIEByZWRyYXdPblJlc2l6ZSA9IHRydWVcblxuICAgICAgICAjIG1hcmdpbi50b3AgICAgICA9IGhlaWdodCAqIDAuMDBcbiAgICAgICAgIyBtYXJnaW4uYm90dG9tICAgPSBoZWlnaHQgKiAwLjE3NVxuICAgICAgICAjIG1hcmdpbi5yaWdodCAgICA9IHdpZHRoICAqIDAuMDBcbiAgICAgICAgIyBtYXJnaW4ubGVmdCAgICAgPSB3aWR0aCAgKiAwLjAgKyAyMFxuICAgICAgICBAbWFyZ2luID0gIHtcbiAgICAgICAgICAgIGxlZnQgICA6IDUwXG4gICAgICAgICAgICByaWdodCAgOiAzMFxuICAgICAgICAgICAgdG9wICAgIDogMzBcbiAgICAgICAgICAgIGJvdHRvbSA6IDQwXG4gICAgICAgIH1cblxuXG4gICAgICAgIHN1cGVyIEAkZWxlLEBncmFwaERhdGFcblxuXG5cbiAgICBvblJlbmRlciA6IC0+XG5cblxuICAgICAgICAjIHggPSBkMy5zY2FsZS5vcmRpbmFsKCkuZG9tYWluKF9kYXRhLm1hcCgoZCwgaSkgLT5cbiAgICAgICAgIyAgICAgX2xhYmVsc1tpXVxuICAgICAgICAjICkpXG5cbiAgICAgICAgIyB4MSA9IGQzLnNjYWxlLm9yZGluYWwoKS5kb21haW4oX2RhdGEubWFwKChkLCBpKSAtPlxuICAgICAgICAjICAgICBpXG4gICAgICAgICMgKSlcblxuICAgICAgICBoZWlnaHQgPSBAaGVpZ2h0XG5cblxuICAgICAgICB5U2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKS5yYW5nZShbQGhlaWdodCwwXSlcblxuICAgICAgICB4U2NhbGUgPSBkMy5zY2FsZS5vcmRpbmFsKCkucmFuZ2VSb3VuZEJhbmRzKFswLCBAd2lkdGhdLCAuMylcblxuICAgICAgICBjb2xvclNjYWxlID0gZDMuc2NhbGUub3JkaW5hbCgpLnJhbmdlKEBncmFwaERhdGEuY29sb3JzIHx8IEBjb2xvcnMpXG5cbiAgICAgICAgaG92ZXJMYWJlbCA9IGQzLnNjYWxlLm9yZGluYWwoKS5yYW5nZShAZ3JhcGhEYXRhLmxhYmVscylcblxuICAgICAgICB5QXhpcyA9IGQzLnN2Z1xuICAgICAgICAgICAgLmF4aXMoKVxuICAgICAgICAgICAgLnNjYWxlKHlTY2FsZSlcbiAgICAgICAgICAgIC50aWNrU2l6ZSgtQHdpZHRoIC0gNSwgMCwgMClcbiAgICAgICAgICAgIC50aWNrcyg1KVxuICAgICAgICAgICAgLnRpY2tGb3JtYXQoKGQsIGluZGV4KSAtPlxuICAgICAgICAgICAgICAgIGlmIGluZGV4ID09IDBcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZFxuICAgICAgICAgICAgKS5vcmllbnQoJ2xlZnQnKVxuXG4gICAgICAgIHhCYXIgPSBkMy5zdmdcbiAgICAgICAgICAgIC5heGlzKClcbiAgICAgICAgICAgIC5zY2FsZSh4U2NhbGUpXG4gICAgICAgICAgICAudGlja3MoQGdyYXBoRGF0YS5kYXRhLmxlbmd0aC0xKVxuICAgICAgICAgICAgLnRpY2tTaXplKGhlaWdodCAsIDAsIDApXG4gICAgICAgICAgICAudGlja0Zvcm1hdCgoZCwgaW5kZXgpID0+XG4gICAgICAgICAgICAgICAgcmV0dXJuIEBncmFwaERhdGEuZGF0YVtpbmRleF0ubGFiZWwudG9VcHBlckNhc2UoKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLm9yaWVudCgnYm90dG9tJylcblxuXG5cbiAgICAgICAgZ3JwZEdyYXBoRGF0YSA9IEBncmFwaERhdGEubGFiZWxzLm1hcCgobikgPT5cbiAgICAgICAgICAgIEBncmFwaERhdGEuZGF0YS5tYXAgKGQsIGkpIC0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB4OiBpXG4gICAgICAgICAgICAgICAgICAgIHk6IGRbbl1cbiAgICAgICAgICAgICAgICAgICAgeTA6IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIClcblxuICAgICAgICBkMy5sYXlvdXQuc3RhY2soKSBncnBkR3JhcGhEYXRhXG5cbiAgICAgICAgI1NldHRpbmcgRG9tYWluXG4gICAgICAgIGF1dG9Eb21haW5DYWxjID0gKGF4aXMpPT5cbiAgICAgICAgICAgIGlzU3RyaW5nID0gZmFsc2VcbiAgICAgICAgICAgIGlmIHR5cGVvZiBAZ3JhcGhEYXRhLmRhdGFbMF1bYXhpc10gaXMgXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgIGlzU3RyaW5nID0gdHJ1ZVxuXG4gICAgICAgICAgICBjYWxsYmFjayA9IChkLGluZGV4KSAtPlxuICAgICAgICAgICAgICAgIGlmIGlzU3RyaW5nXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbmRleFxuICAgICAgICAgICAgICAgIHN1bSA9IDBcbiAgICAgICAgICAgICAgICBmb3Igayx2IG9mIGRcbiAgICAgICAgICAgICAgICAgICAgaWYgayBpcyAnbGFiZWwnXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxuICAgICAgICAgICAgICAgICAgICBzdW0gKz0gdlxuICAgICAgICAgICAgICAgIHJldHVybiAgc3VtXG5cbiAgICAgICAgICAgICN0aGlzIHVzZXMgaW5kZXhcbiAgICAgICAgICAgIHJldHVybiBbMCxkMy5tYXgoQGdyYXBoRGF0YS5kYXRhLGNhbGxiYWNrKSoxLjJdXG5cbiAgICAgICAgeERvbWFpbiA9IFswLEBncmFwaERhdGEuZGF0YS5sZW5ndGgtMV1cbiAgICAgICAgeURvbWFpbiA9IFtcbiAgICAgICAgICAgICAgICAwXG4gICAgICAgICAgICAgICAgZDMubWF4KEBncmFwaERhdGEuZGF0YSwgKGQsIGkpIC0+XG4gICAgICAgICAgICAgICAgICAgIGB2YXIgYmFyV2BcbiAgICAgICAgICAgICAgICAgICAgZFxuICAgICAgICAgICAgICAgICkgKiAxLjc1XG4gICAgICAgICAgICBdXG5cbiAgICAgICAgeFNjYWxlLmRvbWFpbih4RG9tYWluKVxuICAgICAgICB5U2NhbGUuZG9tYWluKHlEb21haW4pXG5cblxuICAgICAgICBAZ3JhcGhHcnAuYXBwZW5kKCdnJykuYXR0cignY2xhc3MnLCAneGF4aXMnKS5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIDAgKyAnKScpLmNhbGwgeEJhclxuICAgICAgICBAZ3JhcGhHcnAuYXBwZW5kKCdnJykuYXR0cignY2xhc3MnLCAneWF4aXMnKS5jYWxsIHlBeGlzXG5cbiAgICAgICAgYXJlYSA9IGQzLnN2Zy5hcmVhKCkueCgoZCkgLT5cbiAgICAgICAgICAgIHhTY2FsZSBkLnhcbiAgICAgICAgKS55MCgoZCkgLT5cbiAgICAgICAgICAgIHlTY2FsZSBkLnkwXG4gICAgICAgICkueTEoKGQpIC0+XG4gICAgICAgICAgICB5U2NhbGUgZC55ICsgZC55MFxuICAgICAgICApXG5cblxuICAgICAgICBhZ2VHcm91cCA9IEBncmFwaEdycC5zZWxlY3RBbGwoJy52YWxncm91cCcpLmRhdGEoZ3JwZEdyYXBoRGF0YSkuZW50ZXIoKS5hcHBlbmQoJ2cnKS5hdHRyKCdjbGFzcycsICd2YWxncm91cCcpLnN0eWxlKCdmaWxsJywgKGQsIGkpIC0+XG4gICAgICAgICAgICBjb2xvclNjYWxlIGlcbiAgICAgICAgKS5hdHRyKCdjbGFzcycsIChkLCBpKSAtPlxuICAgICAgICAgICAgaG92ZXJMYWJlbCBpXG4gICAgICAgIClcblxuICAgICAgICBhZ2VHcm91cC5hcHBlbmQoJ3BhdGgnKS5hdHRyICdkJywgKGQpIC0+XG4gICAgICAgICAgICBhcmVhIGRcblxuXG4gICAgICAgIHhBeGlzVGlja3MgPSBAc3ZnRWxlLnNlbGVjdEFsbCgnLnhheGlzIC50aWNrIGxpbmUnKVxuICAgICAgICBbZmlyc3RUaWNrLCAuLi4sIGxhc3RUaWNrXSAgPSB4QXhpc1RpY2tzWzBdXG4gICAgICAgIGQzLnNlbGVjdChmaXJzdFRpY2spLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMSwwKVwiKVxuICAgICAgICBkMy5zZWxlY3QobGFzdFRpY2spLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoLTEsMClcIilcbiJdfQ==